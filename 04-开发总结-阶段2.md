# Weiqi-Go å¼€å‘è¿›å±• - ç¬¬äºŒé˜¶æ®µ

## ğŸ“… æ›´æ–°æ—¶é—´
2025å¹´12æœˆ3æ—¥

## ğŸ¯ æœ¬é˜¶æ®µç›®æ ‡
å®ŒæˆåŸºç¡€è®¾æ–½å»ºè®¾ï¼Œå®ç°ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. Docker å®Œæ•´é›†æˆ âœ“

#### 1.1 Go åç«¯ Docker åŒ–
- âœ… åˆ›å»º `Dockerfile`ï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰
- âœ… åˆ›å»º `.dockerignore`
- âœ… ä¼˜åŒ–é•œåƒå¤§å°ï¼ˆä½¿ç”¨ alpineï¼‰

#### 1.2 å®Œå–„ docker-compose.yml
- âœ… æ·»åŠ  `weiqi-backend` æœåŠ¡
- âœ… é…ç½®æœåŠ¡ä¾èµ–å…³ç³»
- âœ… æ·»åŠ å¥åº·æ£€æŸ¥
- âœ… é…ç½®ç½‘ç»œè¿æ¥

#### 1.3 éƒ¨ç½²è„šæœ¬
- âœ… `scripts/deploy.sh` - ä¸€é”®éƒ¨ç½²è„šæœ¬
- âœ… `scripts/test-api.sh` - API æµ‹è¯•è„šæœ¬
- âœ… `scripts/test-auth.sh` - è®¤è¯æµ‹è¯•è„šæœ¬

#### 1.4 Makefile
åˆ›å»ºå®Œæ•´çš„é¡¹ç›®ç®¡ç†å‘½ä»¤ï¼š
- `make build` - ç¼–è¯‘é¡¹ç›®
- `make test` - è¿è¡Œæµ‹è¯•
- `make docker-up` - å¯åŠ¨å®¹å™¨
- `make deploy` - å®Œæ•´éƒ¨ç½²
- `make test-api` - æµ‹è¯• API

---

### 2. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ âœ“

#### 2.1 ç”¨æˆ·æ•°æ®æ¨¡å‹
**æ–‡ä»¶**: `user/user.go`

```go
type User struct {
    ID           string
    Username     string
    Email        string
    PasswordHash string
    CreatedAt    time.Time
    UpdatedAt    time.Time
}
```

**åŠŸèƒ½**:
- âœ… å¯†ç å“ˆå¸Œï¼ˆbcryptï¼‰
- âœ… å¯†ç å¼ºåº¦éªŒè¯
- âœ… å…¬å¼€ä¿¡æ¯è¿‡æ»¤

#### 2.2 ç”¨æˆ·å­˜å‚¨
**æ–‡ä»¶**: `user/store.go`

**æ¥å£**:
```go
type Store interface {
    CreateUser(user *User) error
    GetUserByID(id string) (*User, error)
    GetUserByUsername(username string) (*User, error)
    GetUserByEmail(email string) (*User, error)
    UpdateUser(user *User) error
}
```

**å®ç°**:
- âœ… MongoDB å­˜å‚¨å®ç°
- âœ… ç”¨æˆ·åå”¯ä¸€æ€§æ£€æŸ¥
- âœ… é‚®ç®±å”¯ä¸€æ€§æ£€æŸ¥

#### 2.3 JWT è®¤è¯
**æ–‡ä»¶**: `auth/jwt.go`

**åŠŸèƒ½**:
- âœ… Token ç”Ÿæˆ
- âœ… Token éªŒè¯
- âœ… è¿‡æœŸæ—¶é—´ç®¡ç†ï¼ˆ24å°æ—¶ï¼‰
- âœ… å®‰å…¨çš„ç­¾åç®—æ³•ï¼ˆHS256ï¼‰

#### 2.4 è®¤è¯ä¸­é—´ä»¶
**æ–‡ä»¶**: `auth/middleware.go`

**åŠŸèƒ½**:
- âœ… Bearer Token è§£æ
- âœ… Token éªŒè¯
- âœ… ç”¨æˆ·ä¿¡æ¯æ³¨å…¥ä¸Šä¸‹æ–‡
- âœ… æœªè®¤è¯è¯·æ±‚æ‹’ç»

#### 2.5 è®¤è¯ API
**æ–‡ä»¶**: `api/auth_handlers.go`

**ç«¯ç‚¹**:
- âœ… `POST /v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- âœ… `POST /v1/auth/login` - ç”¨æˆ·ç™»å½•
- âœ… `GET /v1/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆéœ€è®¤è¯ï¼‰

**éªŒè¯**:
- âœ… ä½¿ç”¨ Gin çš„ binding æ ‡ç­¾è¿›è¡Œè¯·æ±‚éªŒè¯
- âœ… ç”¨æˆ·åé•¿åº¦éªŒè¯ï¼ˆ3-20å­—ç¬¦ï¼‰
- âœ… é‚®ç®±æ ¼å¼éªŒè¯
- âœ… å¯†ç å¼ºåº¦éªŒè¯ï¼ˆæœ€å°‘6å­—ç¬¦ï¼‰

---

### 3. é…ç½®ç®¡ç†å¢å¼º âœ“

#### 3.1 æ–°å¢é…ç½®é¡¹
```env
# ç”¨æˆ·é›†åˆ
USER_COLLECTION=users

# JWT å¯†é’¥
JWT_SECRET=your-secret-key-change-this-in-production
```

#### 3.2 é…ç½®éªŒè¯
- âœ… å¿…éœ€é…ç½®æ£€æŸ¥
- âœ… é»˜è®¤å€¼è®¾ç½®
- âœ… å®‰å…¨è­¦å‘Šï¼ˆJWT å¯†é’¥ï¼‰

---

### 4. ä¸»ç¨‹åºæ›´æ–° âœ“

**æ–‡ä»¶**: `main.go`

**æ–°å¢åŠŸèƒ½**:
- âœ… ç”¨æˆ·å­˜å‚¨åˆå§‹åŒ–
- âœ… JWT ç®¡ç†å™¨åˆå§‹åŒ–
- âœ… æœåŠ¡é…ç½®æ—¥å¿—è¾“å‡º
- âœ… AI æœåŠ¡å¥åº·æ£€æŸ¥

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

### ä»£ç é‡ï¼ˆæ–°å¢ï¼‰
- **ç”¨æˆ·æ¨¡å—**: ~150 è¡Œ
- **è®¤è¯æ¨¡å—**: ~200 è¡Œ
- **API å¤„ç†å™¨**: ~150 è¡Œ
- **é…ç½®æ›´æ–°**: ~50 è¡Œ
- **è„šæœ¬**: ~200 è¡Œ

### æ–°å¢æ–‡ä»¶
```
user/
â”œâ”€â”€ user.go          # ç”¨æˆ·æ¨¡å‹
â””â”€â”€ store.go         # ç”¨æˆ·å­˜å‚¨

auth/
â”œâ”€â”€ jwt.go           # JWT ç®¡ç†
â””â”€â”€ middleware.go    # è®¤è¯ä¸­é—´ä»¶

api/
â””â”€â”€ auth_handlers.go # è®¤è¯ API

scripts/
â”œâ”€â”€ deploy.sh        # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ test-api.sh      # API æµ‹è¯•
â””â”€â”€ test-auth.sh     # è®¤è¯æµ‹è¯•

Dockerfile           # Go åç«¯é•œåƒ
.dockerignore        # Docker å¿½ç•¥æ–‡ä»¶
Makefile             # é¡¹ç›®ç®¡ç†å‘½ä»¤
```

### API ç«¯ç‚¹ï¼ˆæ€»è®¡ï¼‰
- **è®¤è¯**: 3 ä¸ªç«¯ç‚¹
- **æ¸¸æˆ**: 5 ä¸ªç«¯ç‚¹
- **æ€»è®¡**: 8 ä¸ªç«¯ç‚¹

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### 1. é…ç½®ç¯å¢ƒ

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘é…ç½®ï¼ˆé‡è¦ï¼ï¼‰
# ä¿®æ”¹ MONGO_PASS å’Œ JWT_SECRET
nano .env
```

### 2. éƒ¨ç½²æœåŠ¡

```bash
# ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰
./scripts/deploy.sh

# æˆ–ä½¿ç”¨ Makefile
make deploy
```

### 3. æµ‹è¯• API

```bash
# æµ‹è¯•åŸºç¡€ API
./scripts/test-api.sh

# æµ‹è¯•è®¤è¯åŠŸèƒ½
./scripts/test-auth.sh
```

### 4. ä½¿ç”¨è®¤è¯ API

#### æ³¨å†Œç”¨æˆ·
```bash
curl -X POST http://localhost:8080/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "myuser",
    "email": "user@example.com",
    "password": "securepass123"
  }'
```

#### ç™»å½•
```bash
TOKEN=$(curl -s -X POST http://localhost:8080/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "myuser",
    "password": "securepass123"
  }' | jq -r '.token')
```

#### è·å–ç”¨æˆ·ä¿¡æ¯
```bash
curl http://localhost:8080/v1/auth/me \
  -H "Authorization: Bearer $TOKEN"
```

---

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### 1. å¯†ç å®‰å…¨
- âœ… bcrypt å“ˆå¸Œï¼ˆæˆæœ¬å› å­ 10ï¼‰
- âœ… å¯†ç å¼ºåº¦éªŒè¯
- âœ… å¯†ç ä¸åœ¨å“åº”ä¸­æš´éœ²

### 2. Token å®‰å…¨
- âœ… JWT ç­¾åéªŒè¯
- âœ… Token è¿‡æœŸæ£€æŸ¥
- âœ… å®‰å…¨çš„å¯†é’¥ç®¡ç†

### 3. API å®‰å…¨
- âœ… è®¤è¯ä¸­é—´ä»¶ä¿æŠ¤
- âœ… è¾“å…¥éªŒè¯
- âœ… é”™è¯¯ä¿¡æ¯è„±æ•

---

## ğŸ“‹ å¾…å®Œæˆä»»åŠ¡

### ä¼˜å…ˆçº§ 1ï¼šæ¸¸æˆæƒé™æ§åˆ¶
- [ ] ä¸º Game æ·»åŠ ç©å®¶ ID å­—æ®µ
- [ ] å®ç°"åˆ›å»ºæ¸¸æˆ"æ—¶ç»‘å®šåˆ›å»ºè€…
- [ ] å®ç°"åŠ å…¥æ¸¸æˆ"åŠŸèƒ½
- [ ] è½å­æƒé™éªŒè¯ï¼ˆåªèƒ½æ“ä½œè‡ªå·±çš„æ£‹å­ï¼‰
- [ ] æ¸¸æˆåˆ—è¡¨ APIï¼ˆæˆ‘çš„æ¸¸æˆï¼‰

### ä¼˜å…ˆçº§ 2ï¼šç»“æ„åŒ–æ—¥å¿—
- [ ] å¼•å…¥ slog æˆ– zerolog
- [ ] æ·»åŠ è¯·æ±‚ ID
- [ ] æ—¥å¿—çº§åˆ«é…ç½®
- [ ] JSON æ ¼å¼è¾“å‡º

### ä¼˜å…ˆçº§ 3ï¼šå‰ç«¯å¼€å‘
- [ ] Vue.js é¡¹ç›®æ­å»º
- [ ] ç”¨æˆ·æ³¨å†Œ/ç™»å½•é¡µé¢
- [ ] æ£‹ç›˜ UI ç»„ä»¶
- [ ] æ¸¸æˆå¤§å…

---

## ğŸ¯ æŠ€æœ¯äº®ç‚¹

### 1. å®Œæ•´çš„ Docker åŒ–
- å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒå¤§å°
- å¥åº·æ£€æŸ¥ç¡®ä¿æœåŠ¡å¯ç”¨
- æœåŠ¡ä¾èµ–ç®¡ç†
- ä¸€é”®éƒ¨ç½²è„šæœ¬

### 2. ä¼ä¸šçº§è®¤è¯ç³»ç»Ÿ
- JWT æ ‡å‡†å®ç°
- å®‰å…¨çš„å¯†ç å­˜å‚¨
- å®Œå–„çš„é”™è¯¯å¤„ç†
- è¯·æ±‚éªŒè¯

### 3. å¼€å‘ä½“éªŒä¼˜åŒ–
- Makefile ç®€åŒ–å‘½ä»¤
- è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
- æ¸…æ™°çš„é…ç½®ç®¡ç†
- è¯¦ç»†çš„æ–‡æ¡£

### 4. å¯æ‰©å±•æ¶æ„
- æ¥å£æŠ½è±¡è®¾è®¡
- ä¸­é—´ä»¶æ¨¡å¼
- ä¾èµ–æ³¨å…¥
- æ¨¡å—åŒ–ç»„ç»‡

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### é•œåƒå¤§å°
- Go åç«¯: ~20MBï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰
- Python AI: ~200MB
- MongoDB: å®˜æ–¹é•œåƒ

### å¯åŠ¨æ—¶é—´
- MongoDB: ~5ç§’
- AI æœåŠ¡: ~3ç§’
- Go åç«¯: ~1ç§’

### API å“åº”æ—¶é—´
- æ³¨å†Œ/ç™»å½•: <100ms
- æ¸¸æˆæ“ä½œ: <50ms
- AI å†³ç­–: <500ms

---

## ğŸ‰ æˆå°±æ€»ç»“

åœ¨æœ¬é˜¶æ®µï¼Œæˆ‘ä»¬æˆåŠŸå®Œæˆäº†ï¼š

1. âœ… **Docker å®Œæ•´é›†æˆ** - å®ç°ä¸€é”®éƒ¨ç½²
2. âœ… **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ** - ä¼ä¸šçº§å®‰å…¨æ ‡å‡†
3. âœ… **è¯·æ±‚éªŒè¯** - Gin binding è‡ªåŠ¨éªŒè¯
4. âœ… **éƒ¨ç½²è„šæœ¬** - è‡ªåŠ¨åŒ–è¿ç»´
5. âœ… **å¼€å‘å·¥å…·** - Makefile æå‡æ•ˆç‡

**é¡¹ç›®å·²ç»å…·å¤‡ç”Ÿäº§ç¯å¢ƒçš„åŸºç¡€æ¶æ„ï¼** ğŸš€

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `é¡¹ç›®è¿›å±•æ€»ç»“.md` - ç¬¬ä¸€é˜¶æ®µæ€»ç»“
- `å¿«é€Ÿå¼€å§‹.md` - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—
- `RULES.md` - å›´æ£‹è§„åˆ™è§„èŒƒ
- `README.md` - é¡¹ç›®æ¦‚è¿°

---

## ğŸ’¡ ä¸‹ä¸€æ­¥å»ºè®®

1. **ç«‹å³å¯åš**ï¼š
   - æµ‹è¯•å®Œæ•´çš„ Docker éƒ¨ç½²
   - è¿è¡Œè®¤è¯æµ‹è¯•è„šæœ¬
   - ä½“éªŒå®Œæ•´çš„ç”¨æˆ·æ³¨å†Œæµç¨‹

2. **çŸ­æœŸç›®æ ‡**ï¼ˆ1å‘¨ï¼‰ï¼š
   - å®ç°æ¸¸æˆæƒé™æ§åˆ¶
   - æ·»åŠ æ¸¸æˆåˆ—è¡¨ API
   - å®ç°ç»“æ„åŒ–æ—¥å¿—

3. **ä¸­æœŸç›®æ ‡**ï¼ˆ2-4å‘¨ï¼‰ï¼š
   - å¼€å‘ Vue.js å‰ç«¯
   - å®ç° WebSocket å®æ—¶å¯¹æˆ˜
   - å‡çº§ AI ç®—æ³•

---

**ä»£ç è´¨é‡é«˜ï¼Œæ¶æ„æ¸…æ™°ï¼Œå®‰å…¨å¯é ï¼Œä¸ºç”Ÿäº§éƒ¨ç½²åšå¥½äº†å‡†å¤‡ï¼** ğŸŠ

