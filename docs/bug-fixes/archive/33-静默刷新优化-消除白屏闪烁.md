# âš¡ é™é»˜åˆ·æ–°ä¼˜åŒ– - æ¶ˆé™¤ç™½å±é—ªçƒ

**ä¼˜åŒ–æ—¶é—´**: 2025å¹´12æœˆ4æ—¥  
**ä¼˜åŒ–å†…å®¹**: é™é»˜åˆ·æ–° + æ™ºèƒ½æ£€æµ‹å¯¹æ‰‹åŠ å…¥

---

## ğŸ¯ é—®é¢˜æè¿°

### é—®é¢˜ 1: ç™½å±é—ªçƒ âŒ

**ç°è±¡**:
```
æ¸¸æˆç•Œé¢æ¯ 2 ç§’åˆ·æ–°ä¸€æ¬¡
â†“
æ•´ä¸ªé¡µé¢ç™½å±é—ªçƒ
â†“
ç”¨æˆ·ä½“éªŒå¾ˆå·®
```

**åŸå› **: 
- `refreshing.value = true` å¯¼è‡´æ•´ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“
- åˆ·æ–°æ—¶æ˜¾ç¤º loading çŠ¶æ€ï¼Œé¡µé¢é—ªçƒ

---

### é—®é¢˜ 2: ç­‰å¾…å¯¹æ‰‹ä¸æ™ºèƒ½ âŒ

**ç°è±¡**:
```
ç©å®¶ A åˆ›å»ºæ¸¸æˆ â†’ ç­‰å¾…å¯¹æ‰‹
â†“
ç©å®¶ B åŠ å…¥æ¸¸æˆ
â†“
ç©å®¶ A ä¸çŸ¥é“å¯¹æ‰‹å·²åŠ å…¥ âŒ
â†“
éœ€è¦æ‰‹åŠ¨åˆ·æ–°æ‰èƒ½çœ‹åˆ°
```

**åŸå› **: 
- å¤§å…æ²¡æœ‰è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- æ— æ³•å®æ—¶æ£€æµ‹å¯¹æ‰‹åŠ å…¥

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ ¸å¿ƒæ€è·¯

#### 1. é™é»˜åˆ·æ–°ï¼ˆSilent Refreshï¼‰

```typescript
// ä¿®æ”¹å‰ âŒ
const refreshGame = async () => {
  refreshing.value = true  // è§¦å‘ loadingï¼Œå¯¼è‡´ç™½å±
  await gameStore.fetchGame(gameId)
  refreshing.value = false
}

// ä¿®æ”¹å âœ…
const silentRefreshGame = async () => {
  // ä¸è®¾ç½® refreshingï¼Œç›´æ¥æ›´æ–°æ•°æ®
  await gameStore.fetchGame(gameId)
  // æ²¡æœ‰ loading çŠ¶æ€ï¼Œæ²¡æœ‰ç™½å±
}
```

**æ•ˆæœå¯¹æ¯”**:

| æ–¹å¼ | è§†è§‰æ•ˆæœ | ç”¨æˆ·ä½“éªŒ |
|------|---------|---------|
| **æ™®é€šåˆ·æ–°** | ç™½å±é—ªçƒ âŒ | å¹²æ‰°ç”¨æˆ· âŒ |
| **é™é»˜åˆ·æ–°** | æ— æ„Ÿæ›´æ–° âœ… | æµç•…è‡ªç„¶ âœ… |

---

#### 2. æ™ºèƒ½æ£€æµ‹å¯¹æ‰‹åŠ å…¥

```typescript
// å¤§å…è‡ªåŠ¨åˆ·æ–°
const startAutoRefresh = () => {
  autoRefreshTimer.value = window.setInterval(() => {
    silentRefreshAll()  // é™é»˜åˆ·æ–°ï¼Œä¸é—ªçƒ
  }, 3000)  // æ¯ 3 ç§’æ£€æµ‹ä¸€æ¬¡
}
```

**æ•ˆæœ**:
```
ç©å®¶ A åˆ›å»ºæ¸¸æˆ â†’ ç­‰å¾…å¯¹æ‰‹
â†“
å¤§å…æ¯ 3 ç§’é™é»˜åˆ·æ–° âš¡
â†“
ç©å®¶ B åŠ å…¥æ¸¸æˆ
â†“
3 ç§’å†…ç©å®¶ A è‡ªåŠ¨çœ‹åˆ°å¯¹æ‰‹åŠ å…¥ âœ…
```

---

## ğŸ“ è¯¦ç»†ä¿®æ”¹

### ä¿®æ”¹ 1: Game.vue - æ¸¸æˆç•Œé¢é™é»˜åˆ·æ–°

#### 1.1 æ·»åŠ é™é»˜åˆ·æ–°å‡½æ•°

**weiqi-frontend/src/views/Game.vue**:

```typescript
// é™é»˜åˆ·æ–°æ¸¸æˆçŠ¶æ€ï¼ˆç”¨äºè‡ªåŠ¨åˆ·æ–°ï¼Œä¸æ˜¾ç¤º loadingï¼‰
const silentRefreshGame = async () => {
  try {
    await gameStore.fetchGame(gameId)
    
    // æ›´æ–°æœ¬åœ°æ—¶é—´
    if (gameStore.currentGame) {
      localBlackTime.value = gameStore.currentGame.black_time_left || 0
      localWhiteTime.value = gameStore.currentGame.white_time_left || 0
    }
  } catch (error: any) {
    console.error('Silent refresh game error:', error)
    // é™é»˜åˆ·æ–°å¤±è´¥ä¸æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œé¿å…æ‰“æ‰°ç”¨æˆ·
  }
}
```

**å…³é”®ç‚¹**:
- âœ… ä¸è®¾ç½® `refreshing.value`
- âœ… ä¸æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
- âœ… åªæ›´æ–°æ•°æ®ï¼Œä¸è§¦å‘ UI é‡æ¸²æŸ“

---

#### 1.2 ä¿ç•™æ‰‹åŠ¨åˆ·æ–°å‡½æ•°

```typescript
// æ‰‹åŠ¨åˆ·æ–°æ¸¸æˆçŠ¶æ€ï¼ˆæ˜¾ç¤º loadingï¼‰
const refreshGame = async () => {
  refreshing.value = true
  try {
    await silentRefreshGame()
  } catch (error: any) {
    ElMessage.error('åˆ·æ–°å¤±è´¥')
  } finally {
    refreshing.value = false
  }
}
```

**ç”¨é€”**:
- ç”¨æˆ·ç‚¹å‡»"åˆ·æ–°"æŒ‰é’®æ—¶è°ƒç”¨
- æ˜¾ç¤º loading çŠ¶æ€ï¼Œæä¾›åé¦ˆ

---

#### 1.3 ä¿®æ”¹è‡ªåŠ¨åˆ·æ–°é€»è¾‘

```typescript
// ä¿®æ”¹å‰ âŒ
const startAutoRefresh = () => {
  if (!gameStore.currentGame?.is_ai_game) {
    autoRefreshTimer.value = window.setInterval(() => {
      if (!gameStore.currentGame?.game_over && !isMyTurn.value) {
        refreshGame()  // ä¼šé—ªçƒ
      }
    }, 2000)
  }
}

// ä¿®æ”¹å âœ…
const startAutoRefresh = () => {
  if (!gameStore.currentGame?.is_ai_game) {
    autoRefreshTimer.value = window.setInterval(() => {
      if (!gameStore.currentGame?.game_over && !isMyTurn.value) {
        silentRefreshGame()  // ä¸é—ªçƒ
      }
    }, 2000)
  }
}
```

---

#### 1.4 ä¿®æ”¹è¶…æ—¶åˆ·æ–°é€»è¾‘

```typescript
// é»‘æ£‹è¶…æ—¶
if (localBlackTime.value === 0) {
  ElMessage.error('é»‘æ£‹è¶…æ—¶ï¼')
  silentRefreshGame()  // ä½¿ç”¨é™é»˜åˆ·æ–°
}

// ç™½æ£‹è¶…æ—¶
if (localWhiteTime.value === 0) {
  ElMessage.error('ç™½æ£‹è¶…æ—¶ï¼')
  silentRefreshGame()  // ä½¿ç”¨é™é»˜åˆ·æ–°
}
```

---

### ä¿®æ”¹ 2: Lobby.vue - å¤§å…æ™ºèƒ½åˆ·æ–°

#### 2.1 æ·»åŠ é™é»˜åˆ·æ–°å‡½æ•°

**weiqi-frontend/src/views/Lobby.vue**:

```typescript
// é™é»˜åŠ è½½æˆ‘çš„æ¸¸æˆï¼ˆç”¨äºè‡ªåŠ¨åˆ·æ–°ï¼‰
const silentLoadMyGames = async () => {
  try {
    myGames.value = await gameAPI.myGames()
  } catch (error: any) {
    console.error('Silent load my games error:', error)
  }
}

// é™é»˜åŠ è½½ç­‰å¾…ä¸­çš„æ¸¸æˆï¼ˆç”¨äºè‡ªåŠ¨åˆ·æ–°ï¼‰
const silentLoadWaitingGames = async () => {
  try {
    waitingGames.value = await gameAPI.waitingGames()
  } catch (error: any) {
    console.error('Silent load waiting games error:', error)
  }
}

// é™é»˜åˆ·æ–°æ‰€æœ‰æ•°æ®
const silentRefreshAll = async () => {
  await Promise.all([silentLoadMyGames(), silentLoadWaitingGames()])
}
```

---

#### 2.2 ä¿®æ”¹æ‰‹åŠ¨åˆ·æ–°å‡½æ•°

```typescript
// åŠ è½½æˆ‘çš„æ¸¸æˆï¼ˆæ‰‹åŠ¨åˆ·æ–°ï¼Œæ˜¾ç¤º loadingï¼‰
const loadMyGames = async () => {
  loadingMyGames.value = true
  try {
    await silentLoadMyGames()
  } catch (error: any) {
    ElMessage.error('åŠ è½½æ¸¸æˆåˆ—è¡¨å¤±è´¥')
  } finally {
    loadingMyGames.value = false
  }
}

// åŠ è½½ç­‰å¾…ä¸­çš„æ¸¸æˆï¼ˆæ‰‹åŠ¨åˆ·æ–°ï¼Œæ˜¾ç¤º loadingï¼‰
const loadWaitingGames = async () => {
  loadingWaitingGames.value = true
  try {
    await silentLoadWaitingGames()
  } catch (error: any) {
    ElMessage.error('åŠ è½½ç­‰å¾…åˆ—è¡¨å¤±è´¥')
  } finally {
    loadingWaitingGames.value = false
  }
}
```

---

#### 2.3 æ·»åŠ è‡ªåŠ¨åˆ·æ–°é€»è¾‘

```typescript
const autoRefreshTimer = ref<number | null>(null)

// å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
const startAutoRefresh = () => {
  // æ¯ 3 ç§’åˆ·æ–°ä¸€æ¬¡ï¼Œæ£€æµ‹å¯¹æ‰‹åŠ å…¥å’Œæ¸¸æˆçŠ¶æ€å˜åŒ–
  autoRefreshTimer.value = window.setInterval(() => {
    silentRefreshAll()
  }, 3000)
}

// åœæ­¢è‡ªåŠ¨åˆ·æ–°
const stopAutoRefresh = () => {
  if (autoRefreshTimer.value) {
    clearInterval(autoRefreshTimer.value)
    autoRefreshTimer.value = null
  }
}
```

---

#### 2.4 ç”Ÿå‘½å‘¨æœŸç®¡ç†

```typescript
import { ref, onMounted, onUnmounted } from 'vue'

onMounted(async () => {
  authStore.initUser()
  await Promise.all([loadMyGames(), loadWaitingGames()])
  // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
  startAutoRefresh()
})

onUnmounted(() => {
  // æ¸…ç†å®šæ—¶å™¨
  stopAutoRefresh()
})
```

---

## ğŸ“Š æ•ˆæœå¯¹æ¯”

### æ¸¸æˆç•Œé¢åˆ·æ–°

#### ä¿®æ”¹å‰ âŒ

```
å¯¹æ–¹è½å­
â†“
2 ç§’åè‡ªåŠ¨åˆ·æ–°
â†“
refreshing.value = true
â†“
æ•´ä¸ªé¡µé¢ç™½å±é—ªçƒ âŒ
â†“
çœ‹åˆ°å¯¹æ–¹çš„æ£‹å­
```

**ç”¨æˆ·ä½“éªŒ**: 
- âŒ ç™½å±é—ªçƒ
- âŒ å¹²æ‰°è§†çº¿
- âŒ æ„Ÿè§‰å¡é¡¿

---

#### ä¿®æ”¹å âœ…

```
å¯¹æ–¹è½å­
â†“
2 ç§’åé™é»˜åˆ·æ–°
â†“
åªæ›´æ–°æ•°æ®ï¼Œä¸è§¦å‘ loading
â†“
æ£‹ç›˜å¹³æ»‘æ›´æ–° âœ…
â†“
çœ‹åˆ°å¯¹æ–¹çš„æ£‹å­
```

**ç”¨æˆ·ä½“éªŒ**: 
- âœ… æ— ç™½å±é—ªçƒ
- âœ… æµç•…è‡ªç„¶
- âœ… æ— æ„ŸçŸ¥æ›´æ–°

---

### å¤§å…ç­‰å¾…å¯¹æ‰‹

#### ä¿®æ”¹å‰ âŒ

```
ç©å®¶ A åˆ›å»ºæ¸¸æˆ
â†“
ç­‰å¾…å¯¹æ‰‹...
â†“
ç©å®¶ B åŠ å…¥
â†“
ç©å®¶ A ä¸çŸ¥é“ âŒ
â†“
éœ€è¦æ‰‹åŠ¨åˆ·æ–°
```

**ç”¨æˆ·ä½“éªŒ**: 
- âŒ ä¸çŸ¥é“å¯¹æ‰‹æ˜¯å¦åŠ å…¥
- âŒ éœ€è¦æ‰‹åŠ¨åˆ·æ–°
- âŒ ä½“éªŒä¸è¿è´¯

---

#### ä¿®æ”¹å âœ…

```
ç©å®¶ A åˆ›å»ºæ¸¸æˆ
â†“
ç­‰å¾…å¯¹æ‰‹...
â†“
å¤§å…æ¯ 3 ç§’é™é»˜åˆ·æ–° âš¡
â†“
ç©å®¶ B åŠ å…¥
â†“
3 ç§’å†…ç©å®¶ A è‡ªåŠ¨çœ‹åˆ° âœ…
```

**ç”¨æˆ·ä½“éªŒ**: 
- âœ… è‡ªåŠ¨æ£€æµ‹å¯¹æ‰‹åŠ å…¥
- âœ… æ— éœ€æ‰‹åŠ¨åˆ·æ–°
- âœ… ä½“éªŒæµç•…

---

## ğŸ¯ æŠ€æœ¯ç»†èŠ‚

### é™é»˜åˆ·æ–° vs æ™®é€šåˆ·æ–°

| ç‰¹æ€§ | é™é»˜åˆ·æ–° | æ™®é€šåˆ·æ–° |
|------|---------|---------|
| **è®¾ç½® loading** | âŒ å¦ | âœ… æ˜¯ |
| **æ˜¾ç¤ºé”™è¯¯** | âŒ å¦ | âœ… æ˜¯ |
| **è§¦å‘é‡æ¸²æŸ“** | âŒ æœ€å°åŒ– | âœ… å®Œæ•´ |
| **ç™½å±é—ªçƒ** | âŒ æ—  | âœ… æœ‰ |
| **ç”¨æˆ·æ„ŸçŸ¥** | âœ… æ— æ„Ÿ | âŒ æ˜æ˜¾ |
| **é€‚ç”¨åœºæ™¯** | è‡ªåŠ¨åˆ·æ–° | æ‰‹åŠ¨åˆ·æ–° |

---

### åˆ·æ–°é—´éš”é€‰æ‹©

#### æ¸¸æˆç•Œé¢

```typescript
// 2 ç§’åˆ·æ–°é—´éš”
autoRefreshTimer.value = window.setInterval(() => {
  silentRefreshGame()
}, 2000)
```

**åŸå› **:
- âœ… æ¥è¿‘å®æ—¶ï¼ˆå¯¹æ–¹è½å­å 2 ç§’å†…çœ‹åˆ°ï¼‰
- âœ… æœåŠ¡å™¨å‹åŠ›å¯æ¥å—
- âœ… ç½‘ç»œå¼€é”€åˆç†

---

#### å¤§å…ç•Œé¢

```typescript
// 3 ç§’åˆ·æ–°é—´éš”
autoRefreshTimer.value = window.setInterval(() => {
  silentRefreshAll()
}, 3000)
```

**åŸå› **:
- âœ… å¤§å…çŠ¶æ€å˜åŒ–è¾ƒæ…¢
- âœ… 3 ç§’è¶³å¤Ÿå¿«
- âœ… å‡å°‘æœåŠ¡å™¨å‹åŠ›

---

### åˆ·æ–°ç­–ç•¥å¯¹æ¯”

| åœºæ™¯ | é—´éš” | åˆ·æ–°å†…å®¹ | åŸå›  |
|------|------|---------|------|
| **æ¸¸æˆç•Œé¢ï¼ˆå¯¹æ–¹å›åˆï¼‰** | 2ç§’ | æ¸¸æˆçŠ¶æ€ | éœ€è¦å¿«é€Ÿçœ‹åˆ°å¯¹æ–¹è½å­ |
| **æ¸¸æˆç•Œé¢ï¼ˆæˆ‘çš„å›åˆï¼‰** | ä¸åˆ·æ–° | - | é¿å…å¹²æ‰°æ“ä½œ |
| **å¤§å…ï¼ˆç­‰å¾…å¯¹æ‰‹ï¼‰** | 3ç§’ | æ¸¸æˆåˆ—è¡¨ | æ£€æµ‹å¯¹æ‰‹åŠ å…¥ |
| **å¤§å…ï¼ˆæµè§ˆï¼‰** | 3ç§’ | æ¸¸æˆåˆ—è¡¨ | çœ‹åˆ°æœ€æ–°æ¸¸æˆ |

---

## ğŸ”„ å®Œæ•´çš„ç”¨æˆ·ä½“éªŒæµç¨‹

### æµç¨‹ 1: åˆ›å»ºæ¸¸æˆç­‰å¾…å¯¹æ‰‹

```
ç©å®¶ A:
1. åœ¨å¤§å…åˆ›å»ºç©å®¶å¯¹æˆ˜
   â†“
2. è¿›å…¥æ¸¸æˆç•Œé¢ï¼ŒçŠ¶æ€"ç­‰å¾…ç©å®¶"
   â†“
3. å¤§å…æ¯ 3 ç§’é™é»˜åˆ·æ–° âš¡
   â†“
4. ç©å®¶ B åŠ å…¥æ¸¸æˆ
   â†“
5. 3 ç§’å†…ç©å®¶ A çœ‹åˆ°æ¸¸æˆå¼€å§‹ âœ…
   â†“
6. å¼€å§‹å¯¹å¼ˆ
```

---

### æµç¨‹ 2: ç©å®¶å¯¹æˆ˜

```
ç©å®¶ Aï¼ˆé»‘æ£‹ï¼‰:
1. è½å­
   â†“
2. é»‘å­ç«‹å³æ˜¾ç¤º
   â†“
3. ç­‰å¾…ç©å®¶ Bï¼ˆç™½æ£‹ï¼‰
   â†“
4. æ¸¸æˆç•Œé¢æ¯ 2 ç§’é™é»˜åˆ·æ–° âš¡
   â†“
5. 2 ç§’å†…çœ‹åˆ°ç™½å­å‡ºç° âœ…
   â†“
6. æ²¡æœ‰ç™½å±é—ªçƒ âœ…
```

---

### æµç¨‹ 3: æ‰‹åŠ¨åˆ·æ–°

```
ç”¨æˆ·ç‚¹å‡»"åˆ·æ–°"æŒ‰é’®:
1. refreshing.value = true
   â†“
2. æŒ‰é’®æ˜¾ç¤º loading çŠ¶æ€ â³
   â†“
3. è°ƒç”¨ silentRefreshGame()
   â†“
4. æ•°æ®æ›´æ–°
   â†“
5. refreshing.value = false
   â†“
6. æŒ‰é’®æ¢å¤æ­£å¸¸ âœ…
```

**æ³¨æ„**: æ‰‹åŠ¨åˆ·æ–°æ—¶æ˜¾ç¤º loadingï¼Œæä¾›ç”¨æˆ·åé¦ˆ

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

### å‰ç«¯è§†å›¾

#### 1. weiqi-frontend/src/views/Game.vue

**æ–°å¢å‡½æ•°**:
- `silentRefreshGame()` - é™é»˜åˆ·æ–°æ¸¸æˆçŠ¶æ€

**ä¿®æ”¹å‡½æ•°**:
- `refreshGame()` - è°ƒç”¨ `silentRefreshGame()`
- `startAutoRefresh()` - ä½¿ç”¨ `silentRefreshGame()`
- è¶…æ—¶é€»è¾‘ - ä½¿ç”¨ `silentRefreshGame()`

**ä¿®æ”¹åŸå› **:
- æ¶ˆé™¤è‡ªåŠ¨åˆ·æ–°æ—¶çš„ç™½å±é—ªçƒ
- ä¿ç•™æ‰‹åŠ¨åˆ·æ–°çš„ loading åé¦ˆ

---

#### 2. weiqi-frontend/src/views/Lobby.vue

**æ–°å¢å‡½æ•°**:
- `silentLoadMyGames()` - é™é»˜åŠ è½½æˆ‘çš„æ¸¸æˆ
- `silentLoadWaitingGames()` - é™é»˜åŠ è½½ç­‰å¾…æ¸¸æˆ
- `silentRefreshAll()` - é™é»˜åˆ·æ–°æ‰€æœ‰æ•°æ®
- `startAutoRefresh()` - å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
- `stopAutoRefresh()` - åœæ­¢è‡ªåŠ¨åˆ·æ–°

**ä¿®æ”¹å‡½æ•°**:
- `loadMyGames()` - è°ƒç”¨ `silentLoadMyGames()`
- `loadWaitingGames()` - è°ƒç”¨ `silentLoadWaitingGames()`
- `onMounted()` - å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
- `onUnmounted()` - æ¸…ç†å®šæ—¶å™¨

**ä¿®æ”¹åŸå› **:
- å®ç°æ™ºèƒ½æ£€æµ‹å¯¹æ‰‹åŠ å…¥
- æ¶ˆé™¤å¤§å…åˆ·æ–°æ—¶çš„é—ªçƒ

---

## âœ… æµ‹è¯•éªŒè¯

### æµ‹è¯• 1: æ¸¸æˆç•Œé¢æ— ç™½å±

#### æ­¥éª¤
1. å¼€å§‹ä¸€å±€ç©å®¶å¯¹æˆ˜
2. ç­‰å¾…å¯¹æ–¹è½å­
3. è§‚å¯Ÿç•Œé¢åˆ·æ–°

#### é¢„æœŸç»“æœ
- âœ… 2 ç§’å†…çœ‹åˆ°å¯¹æ–¹è½å­
- âœ… æ²¡æœ‰ç™½å±é—ªçƒ
- âœ… æ£‹ç›˜å¹³æ»‘æ›´æ–°
- âœ… ä¸å¹²æ‰°è§†çº¿

---

### æµ‹è¯• 2: å¤§å…æ™ºèƒ½æ£€æµ‹

#### æ­¥éª¤
1. ç©å®¶ A åˆ›å»ºæ¸¸æˆ
2. ç©å®¶ A åœç•™åœ¨å¤§å…
3. ç©å®¶ B åŠ å…¥æ¸¸æˆ
4. è§‚å¯Ÿç©å®¶ A çš„å¤§å…

#### é¢„æœŸç»“æœ
- âœ… 3 ç§’å†…æ¸¸æˆçŠ¶æ€å˜ä¸º"è¿›è¡Œä¸­"
- âœ… æ²¡æœ‰ç™½å±é—ªçƒ
- âœ… è‡ªåŠ¨æ›´æ–°ï¼Œæ— éœ€æ‰‹åŠ¨åˆ·æ–°

---

### æµ‹è¯• 3: æ‰‹åŠ¨åˆ·æ–°åé¦ˆ

#### æ­¥éª¤
1. åœ¨æ¸¸æˆç•Œé¢ç‚¹å‡»"åˆ·æ–°"æŒ‰é’®
2. è§‚å¯ŸæŒ‰é’®çŠ¶æ€

#### é¢„æœŸç»“æœ
- âœ… æŒ‰é’®æ˜¾ç¤º loading çŠ¶æ€
- âœ… åˆ·æ–°å®Œæˆåæ¢å¤æ­£å¸¸
- âœ… æä¾›ç”¨æˆ·åé¦ˆ

---

## ğŸ’¡ æŠ€æœ¯æ€»ç»“

### æ ¸å¿ƒä¼˜åŒ–

1. **é™é»˜åˆ·æ–°** - åªæ›´æ–°æ•°æ®ï¼Œä¸è§¦å‘ UI é‡æ¸²æŸ“
2. **æ™ºèƒ½æ£€æµ‹** - å¤§å…è‡ªåŠ¨æ£€æµ‹å¯¹æ‰‹åŠ å…¥
3. **åˆ†ç¦»å…³æ³¨ç‚¹** - è‡ªåŠ¨åˆ·æ–°å’Œæ‰‹åŠ¨åˆ·æ–°åˆ†å¼€å¤„ç†
4. **èµ„æºç®¡ç†** - ç»„ä»¶å¸è½½æ—¶æ¸…ç†å®šæ—¶å™¨

---

### å…³é”®æŠ€æœ¯ç‚¹

#### 1. é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

```typescript
// âŒ é”™è¯¯ï¼šè§¦å‘é‡æ¸²æŸ“
const refresh = async () => {
  refreshing.value = true  // è§¦å‘ UI æ›´æ–°
  await fetchData()
  refreshing.value = false  // å†æ¬¡è§¦å‘ UI æ›´æ–°
}

// âœ… æ­£ç¡®ï¼šåªæ›´æ–°æ•°æ®
const silentRefresh = async () => {
  await fetchData()  // åªæ›´æ–°æ•°æ®ï¼ŒVue è‡ªåŠ¨å¤„ç†æœ€å°åŒ–é‡æ¸²æŸ“
}
```

---

#### 2. å®šæ—¶å™¨ç®¡ç†

```typescript
// âœ… æ­£ç¡®çš„å®šæ—¶å™¨ç®¡ç†
onMounted(() => {
  startAutoRefresh()  // å¯åŠ¨å®šæ—¶å™¨
})

onUnmounted(() => {
  stopAutoRefresh()  // æ¸…ç†å®šæ—¶å™¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
})
```

---

#### 3. é”™è¯¯å¤„ç†

```typescript
// é™é»˜åˆ·æ–°ï¼šä¸æ˜¾ç¤ºé”™è¯¯
const silentRefresh = async () => {
  try {
    await fetchData()
  } catch (error) {
    console.error(error)  // åªè®°å½•æ—¥å¿—
    // ä¸æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œé¿å…æ‰“æ‰°ç”¨æˆ·
  }
}

// æ‰‹åŠ¨åˆ·æ–°ï¼šæ˜¾ç¤ºé”™è¯¯
const manualRefresh = async () => {
  try {
    await silentRefresh()
  } catch (error) {
    ElMessage.error('åˆ·æ–°å¤±è´¥')  // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
  }
}
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### ç½‘ç»œè¯·æ±‚ä¼˜åŒ–

#### æ¸¸æˆç•Œé¢

```
æ¯ 2 ç§’ä¸€æ¬¡ GET è¯·æ±‚
â†“
è¯·æ±‚å¤§å°: ~1-2KB
å“åº”æ—¶é—´: < 100ms
â†“
å¸¦å®½å ç”¨: ~0.5-1 KB/s
```

**è¯„ä¼°**: âœ… å¯æ¥å—

---

#### å¤§å…ç•Œé¢

```
æ¯ 3 ç§’ä¸¤æ¬¡ GET è¯·æ±‚ï¼ˆæˆ‘çš„æ¸¸æˆ + ç­‰å¾…æ¸¸æˆï¼‰
â†“
è¯·æ±‚å¤§å°: ~2-4KB
å“åº”æ—¶é—´: < 100ms
â†“
å¸¦å®½å ç”¨: ~0.7-1.3 KB/s
```

**è¯„ä¼°**: âœ… å¯æ¥å—

---

### CPU ä½¿ç”¨ä¼˜åŒ–

| æ–¹å¼ | CPU ä½¿ç”¨ | åŸå›  |
|------|---------|------|
| **æ™®é€šåˆ·æ–°** | è¾ƒé«˜ | å®Œæ•´é‡æ¸²æŸ“ |
| **é™é»˜åˆ·æ–°** | è¾ƒä½ | æœ€å°åŒ–é‡æ¸²æŸ“ |

**ä¼˜åŒ–æ•ˆæœ**: 
- âœ… å‡å°‘ CPU ä½¿ç”¨
- âœ… æé«˜ç”µæ± ç»­èˆªï¼ˆç§»åŠ¨è®¾å¤‡ï¼‰
- âœ… æ›´æµç•…çš„åŠ¨ç”»

---

## ğŸ‰ ä¼˜åŒ–æ€»ç»“

### è§£å†³çš„é—®é¢˜

- âœ… **ç™½å±é—ªçƒ** â†’ é™é»˜åˆ·æ–°ï¼Œæ— æ„Ÿæ›´æ–°
- âœ… **ç­‰å¾…å¯¹æ‰‹** â†’ æ™ºèƒ½æ£€æµ‹ï¼Œè‡ªåŠ¨æç¤º
- âœ… **ç”¨æˆ·ä½“éªŒ** â†’ æµç•…è‡ªç„¶ï¼Œæ— å¹²æ‰°

---

### æŠ€æœ¯æ”¹è¿›

- âœ… **é™é»˜åˆ·æ–°** - åªæ›´æ–°æ•°æ®ï¼Œä¸é—ªçƒ
- âœ… **æ™ºèƒ½æ£€æµ‹** - è‡ªåŠ¨æ£€æµ‹å¯¹æ‰‹åŠ å…¥
- âœ… **åˆ†ç¦»å…³æ³¨ç‚¹** - è‡ªåŠ¨/æ‰‹åŠ¨åˆ·æ–°åˆ†å¼€
- âœ… **èµ„æºç®¡ç†** - æ­£ç¡®æ¸…ç†å®šæ—¶å™¨

---

### ç”¨æˆ·ä½“éªŒæå‡

| åœºæ™¯ | ä¿®æ”¹å‰ | ä¿®æ”¹å |
|------|-------|-------|
| **æ¸¸æˆåˆ·æ–°** | ç™½å±é—ªçƒ âŒ | å¹³æ»‘æ›´æ–° âœ… |
| **ç­‰å¾…å¯¹æ‰‹** | ä¸çŸ¥é“ âŒ | è‡ªåŠ¨æ£€æµ‹ âœ… |
| **å¤§å…æµè§ˆ** | éœ€æ‰‹åŠ¨åˆ·æ–° âŒ | è‡ªåŠ¨æ›´æ–° âœ… |
| **æ•´ä½“æ„Ÿè§‰** | å¡é¡¿ âŒ | æµç•… âœ… |

---

## ğŸ”® æœªæ¥ä¼˜åŒ–æ–¹å‘

### WebSocket å®æ—¶é€šä¿¡ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦çœŸæ­£çš„å®æ—¶ä½“éªŒï¼š

```typescript
// å½“å‰æ–¹æ¡ˆï¼ˆè½®è¯¢ï¼‰
ä¼˜ç‚¹:
- âœ… å®ç°ç®€å•
- âœ… å…¼å®¹æ€§å¥½
- âœ… 2-3ç§’å»¶è¿Ÿå¯æ¥å—

ç¼ºç‚¹:
- âŒ æœ‰å»¶è¿Ÿ
- âŒ æŒç»­ç½‘ç»œè¯·æ±‚

// WebSocket æ–¹æ¡ˆ
ä¼˜ç‚¹:
- âœ… çœŸæ­£å®æ—¶ï¼ˆ< 100msï¼‰
- âœ… æœåŠ¡å™¨ä¸»åŠ¨æ¨é€
- âœ… å‡å°‘ç½‘ç»œè¯·æ±‚

ç¼ºç‚¹:
- âŒ å®ç°å¤æ‚
- âŒ éœ€è¦åç«¯æ”¯æŒ
- âŒ è¿æ¥ç®¡ç†å¤æ‚
```

**å»ºè®®**: 
- å½“å‰çš„é™é»˜åˆ·æ–°æ–¹æ¡ˆå·²ç»è¶³å¤Ÿå¥½
- 2-3ç§’å»¶è¿Ÿç”¨æˆ·æ„Ÿè§‰ä¸åˆ°
- é™¤éæœ‰å¤§é‡å¹¶å‘ç”¨æˆ·ï¼Œå¦åˆ™ä¸éœ€è¦ WebSocket

---

**âš¡ é™é»˜åˆ·æ–°ä¼˜åŒ–å·²å®Œå…¨å®ç°ï¼** âœ¨

ç°åœ¨å¯ä»¥ï¼š
- âœ… æ¸¸æˆç•Œé¢æ— ç™½å±é—ªçƒ
- âœ… å¤§å…è‡ªåŠ¨æ£€æµ‹å¯¹æ‰‹åŠ å…¥
- âœ… æµç•…è‡ªç„¶çš„ç”¨æˆ·ä½“éªŒ
- âœ… å‡†å®æ—¶çš„çŠ¶æ€æ›´æ–°

